
## Watermarking

**Docma** supports the ability to watermark and stamp PDF documents using
the concept of document *overlays*.

!!! info
    Overlays are not supported for HTML output documents.

An **overlay** is a PDF document, generated by **docma** that can be used as
either a watermark or a stamp.

A **watermark** is content merged into every page of the final PDF **under** the
main document content.

A **stamp** is content merged into every page of the final PDF **over** the
main document content.

Overlays are defined in the [template configuration file](#template-configuration-file)
using the following structure:

```yaml
overlays:
  my-overlay-1:
    # We can have HTML files that will be rendered like other docs
    - a4-portrait.html
    # ... or static PDFs
    - a4-landscape.pdf

  # or ...
  my-overlay-2: a4-portrait.html
```

Each overlay is a named list of documents (or a single document). When **docma**
is requested to add a watermark (or stamp), it is provided with the name of one
or more of the overlays (e.g. `my-overlay-1`).

It will then render each of the files in each overlay list in the same way as the
main document, including rendering with dynamic run-time parameters.

Each page in the main document is then merged with the first page of the first
overlay document in each list that has (approximately) the same page dimensions.

!!! info
    The process will abort if a matching overlay page cannot be found for a main
    document page.

The presence of the `overlays` section in the configuration file does not itself
enable watermarking / stamping. This has to be explicitly requested.

Watermarking / stamping can be requested using the `--watermark` / `--stamp`
CLI options. If using the Python API, the `watermark` / `stamp` parameters to the
`render_template()` function are used.

It is possible to have both watermarking and stamping used on a single document,
as well as having multiple overlays applied to a single document.

!!! info
    A simple grid overlay is provided as part of the basic template created by
    the [docma new](#creating-a-new-document-template) command. This can be
    handy when adjusting page layout. To add the grid, the docma CLI rendering
    command would be `docma pdf --stamp grid ...`. Grid size and colour are
    adjustable in the parameter defaults in the template config file.
